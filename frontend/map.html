<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>세이프홈 - 안전 히트맵</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}">
</head>
<body>
    {% include '_navbar.html' %}
    {% include '_left_sidebar.html' %}
    <div id="main-container">
        <div id="side-panel" class="hidden">
        <div class="panel-header">
                <h2 style="margin:0 0 8px;font-size:18px">지역별 위험도</h2>
                <p style="margin:0;font-size:13px;color:#666">총 <span id="total-regions">0</span>개 지역</p>
        </div>
        <div class="stats-container">
            <div class="stat-card danger">
                <div class="stat-number" id="danger-count">0</div>
                <div class="stat-label">위험</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-number" id="warning-count">0</div>
                <div class="stat-label">주의</div>
            </div>
            <div class="stat-card safe">
                <div class="stat-number" id="safe-count">0</div>
                <div class="stat-label">안전</div>
            </div>
        </div>
        <div class="filter-section">
            <h3>필터</h3>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">전체</button>
                <button class="filter-btn" data-filter="danger">위험</button>
                <button class="filter-btn" data-filter="warning">주의</button>
                <button class="filter-btn" data-filter="safe">안전</button>
            </div>
        </div>
        <div class="region-list" id="region-list"></div>
        </div>
        <div id="right-sidebar" class="hidden">
            <div class="panel-header">
                <h2 style="margin:0;font-size:18px">📊 추가 정보</h2>
            </div>
            <div class="sidebar-section">
                <h3>⭐ 즐겨찾기</h3>
                <div id="favorite-sidebar">
                    <div style="color:#999;font-size:13px;text-align:center;padding:20px">로딩 중...</div>
        </div>
            </div>
            <div class="sidebar-section">
                <h3>🕐 최근 검색</h3>
                <div id="recent-searches">
                    <div style="color:#999;font-size:13px;text-align:center;padding:20px">로딩 중...</div>
                </div>
            </div>
        <div class="sidebar-section">
            <h3>💰 실거래가 조회</h3>
            <div class="real-transaction-search">
                    <input type="text" id="real-tx-region" placeholder="지역명 (예: 청담동)" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;margin-bottom:8px">
                    <button onclick="loadRealTransactions()" style="width:100%;padding:8px;background:#1565c0;color:white;border:none;border-radius:4px;cursor:pointer">조회하기</button>
                </div>
                <div id="real-tx-results" style="margin-top:12px;max-height:300px;overflow-y:auto">
                    <div style="color:#999;font-size:13px;text-align:center;padding:20px">지역을 입력하고 조회하세요</div>
            </div>
            </div>
        <div class="sidebar-section">
            <h3>🔗 빠른 링크</h3>
            <a href="/searchscan" class="quick-link">
                <span class="link-icon">🏠</span>
                <div class="link-text">
                    <div class="link-title">매물 분석</div>
                    <div class="link-desc">매물 상세 정보 확인</div>
                </div>
            </a>
            <a href="/self-check" class="quick-link">
                <span class="link-icon">✅</span>
                <div class="link-text">
                    <div class="link-title">자가 진단</div>
                    <div class="link-desc">안전도 체크리스트</div>
                </div>
            </a>
            <a href="/scam-types" class="quick-link">
                <span class="link-icon">📖</span>
                <div class="link-text">
                    <div class="link-title">사기 유형</div>
                    <div class="link-desc">전세사기 예방법</div>
                </div>
            </a>
            <a href="/about" class="quick-link">
                <span class="link-icon">💬</span>
                <div class="link-text">
                    <div class="link-title">문의하기</div>
                    <div class="link-desc">도움이 필요하신가요?</div>
                </div>
            </a>
        </div>
        <div class="sidebar-section">
            <h3>🎨 위험도 범례</h3>
            <div class="legend-item">
                    <div class="legend-color" style="background:#dc3545"></div>
                <span class="legend-label">위험 (80점 이상)</span>
            </div>
            <div class="legend-item">
                    <div class="legend-color" style="background:#ffc107"></div>
                <span class="legend-label">주의 (60-79점)</span>
            </div>
            <div class="legend-item">
                    <div class="legend-color" style="background:#28a745"></div>
                <span class="legend-label">안전 (60점 미만)</span>
            </div>
        </div>
    </div>
    <div id="search-container">
            <input type="text" id="address-search" list="recent-searches-list" placeholder="분석하고 싶은 주소를 입력하세요 (예: 신림동)">
            <datalist id="recent-searches-list"></datalist>
        <button id="search-btn" type="button">검색</button>
            <button id="clear-btn" style="margin-left:6px;background:#222222">&#10006;</button>
    </div>
    <div id="map"></div>
    <div class="map-title">지도 위에 지역별 전세사기 위험도가 표시됩니다.</div>
    </div>
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8247295f2354056a3b44ceb99ae6d086&libraries=services"></script>
    <script>const SAFEHOME_CONFIG={scannerUrl:"{{ url_for('searchscan_page') }}"};</script>
    <!-- 기존 map.js (필수 함수 포함) -->
    <script src="{{ url_for('static', filename='js/map.js') }}"></script>
    <!-- React 지도 모듈 (마이크로 프론트엔드) - 빌드 후 활성화 -->
    <!-- <script src="{{ url_for('static', filename='js/map-react.js') }}"></script> -->
    {% include '_footer.html' %}
</body>
</html>
